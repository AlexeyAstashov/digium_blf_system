
# Digium BLF System

–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∞–¥—Ä–µ—Å–Ω–æ–π –∫–Ω–∏–≥–∏ BLF (Busy Lamp Field) –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ **Digium**. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º—É –Ω–æ–º–µ—Ä—É –∏ –ø–∞—Ä–æ–ª—é, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ **105 –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é XML-—Ñ–∞–π–ª–∞ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤.


![–°–∫—Ä–∏–Ω—à–æ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://github.com/user-attachments/assets/4f6326d7-691d-4f74-89ca-b38058b50a6e)
![–°–∫—Ä–∏–Ω—à–æ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](https://github.com/user-attachments/assets/1e68d1f4-320b-4fb1-89f5-0b9e050f35a7)
![–°–∫—Ä–∏–Ω—à–æ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SmartBLF](https://github.com/user-attachments/assets/cc06a77b-4c6f-493e-a5df-2d8ab747a552)

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–æ–º–µ—Ä—É –∏ –ø–∞—Ä–æ–ª—é
- üìá –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º BLF-–∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –Ω–æ–º–µ—Ä–æ–≤
- üñ® –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è XML-—Ñ–∞–π–ª–∞ –¥–ª—è Digium-—Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
- üîÑ –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ —á–µ—Ä–µ–∑ Asterisk
- üë§ –ê–¥–º–∏–Ω–∫–∞ —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

![—Å–∫—Ä–∏–Ω—à–æ—Ç –ø–∞–Ω–µ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞](https://github.com/user-attachments/assets/ec1e08b8-8a1d-49c4-bc27-e06b9ccbfbaa)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
digium_blf_system/
‚îú‚îÄ‚îÄ index.php           # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ editor.php          # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –¥–ª—è BFL 
‚îú‚îÄ‚îÄ editor.css          # –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ generate.php        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XML
‚îú‚îÄ‚îÄ admin.php           # –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ config.php          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
‚îú‚îÄ‚îÄ style.css           # –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îú‚îÄ‚îÄ create_hash.php     # –ü–µ—Ä–≤–∏—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è –¥–ª—è –ø–æ–ª—å—â–æ–≤–∞—Ç–µ–ª—è admin –≤ –ë–î
‚îú‚îÄ‚îÄ logout.php          
‚îî‚îÄ‚îÄ ...
```
---
üõ†Ô∏è –ê–¥–º–∏–Ω–∫–∞
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:

–°–æ–∑–¥–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –∏ —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **admin**


‚öôÔ∏è **–£—Å—Ç–∞–Ω–æ–≤–∫–∞**
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```
git clone https://github.com/AlexeyAstashov/digium_blf_system.git
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ **config.php**:
```
return [
    'db_host' => 'localhost',
    'db_name' => 'blf_system',
    'db_user' => 'user',
    'db_pass' => 'password'
];
```

3. –°–æ–∑–¥–∞–π—Ç–µ –ø—É—Å—Ç—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ MySQL/MadiaDB:  **blf_system**


4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```
mysql -u root -p blf_system < blf_structure.sql
```
–§–∞–π–ª **blf_structure.sql** —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü.

5. –ó–∞–π–¥–∏—Ç–µ –≤ —Ñ–∞–π–ª **setup_admin.php** –∏ –ø–æ–º–µ–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª—å **admin** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. (–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1234)
(–≤–ø—Ä–æ—á–µ–º –µ–≥–æ —Ç—É—Ç –º–æ–∂–Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å, –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –≤ –∞–¥–º–∏–Ω–∫—É –≤—ã —Å–º–æ–∂–µ—Ç–µ –µ–≥–æ –ø–æ—Ç–æ–º —Å—Ä–∞–∑—É –ø–æ–º–µ–Ω—è—Ç—å)

6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ 
```
php setup_admin.php
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **admin** —Å–æ–∑–¥–∞—ë—Ç—Å—è 1 —Ä–∞–∑, –µ—Å–ª–∏ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª, —Ç–æ –ø–∞—Ä–æ–ª—å –Ω–µ –ø–æ–º–µ–Ω—è–µ—Ç—è, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å–æ–∑–¥–∞–Ω
–Ω–æ –æ–Ω –ø–æ–¥—Å–∫–∞–∂–µ—Ç –∫–∞–∫ –ø–æ—Å—Ç—É–ø–∏—Ç—å –¥–∞–ª—å—à–µ. –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è **admin** - –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∏–∑ –ë–î –Ω–∞–ø—Ä—è–º—É—é.

(–Ø —Ä–µ—à–∏–ª —Å–¥–µ–ª–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–∞–∫, –±–µ–∑ –≤–Ω–µ—à–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –≤ –æ–±—â–µ–º, —è —Ç–∞–∫ –≤–∏–∂—É)

7. –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É:
```
chown -R asterisk:asterisk /var/www/html/digium_phones/
chmod -R 755 /var/www/html/digium_phones
```



## üîÑ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –Ω–æ–º–µ—Ä–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º.

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å **editor.php** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ 105 BLF-–∫–æ–Ω—Ç–∞–∫—Ç–æ–≤.

–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è XML-—Ñ–∞–π–ª <ext>.xml.

Asterisk –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)

–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–∞ –∏ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤—Ö–æ–¥–µ

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin

**index.php?logout** ‚Äî –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–µ—Å—Å–∏–∏

## üìå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
**PHP 5.6+**

**MariaDB / MySQL**

Asterisk + Digium —Ç–µ–ª–µ—Ñ–æ–Ω—ã (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ XML BLF)

Apache —Å –¥–æ—Å—Ç—É–ø–æ–º –Ω–∞ /var/www/html/digium_phones/

## üìÉ –õ–∏—Ü–µ–Ω–∑–∏—è
–õ–∏—Ü–µ–Ω–∑–∏—è: [GNU GPL v3](LICENSE)

-------------------------------------------------------------------------------

# üìû Digium BLF System

A web interface for managing personal **BLF (Busy Lamp Field)** contact lists for **Digium phones**. Supports authentication by extension and password, up to **105 BLF contacts per user**, and automatic XML generation for phone configuration.

## üöÄ Features

- üîê Login by extension and password
- üìá Manage up to 105 BLF contacts per user
- ‚úÖ Validation and duplicate checks for extensions
- üñ® Automatic XML file generation for Digium phones
- üîÑ Instant configuration reload via Asterisk
- üë§ Admin panel with user management

---
## üìÅ Project Structure
```
digium_blf_system/
‚îú‚îÄ‚îÄ index.php # Login page
‚îú‚îÄ‚îÄ editor.php # BLF contact editor
‚îú‚îÄ‚îÄ editor.css # Editor styling
‚îú‚îÄ‚îÄ generate.php # XML generation logic
‚îú‚îÄ‚îÄ admin.php # Admin panel
‚îú‚îÄ‚îÄ config.php # DB connection settings
‚îú‚îÄ‚îÄ style.css # Common styles
‚îú‚îÄ‚îÄ create_hash.php # Initial admin password hash generator
‚îú‚îÄ‚îÄ logout.php # Logout handler
‚îî‚îÄ‚îÄ ...
```
---

## üõ†Ô∏è Admin Panel

- Create, delete, and change passwords for users
- Admin user (`admin`) is protected from deletion
- Simple and intuitive interface

---

## ‚öôÔ∏è Installation

1. Clone the repository:
```
git clone https://github.com/AlexeyAstashov/digium_blf_system.git
```

2. Configure the database connection in config.php:
```
return [
    'db_host' => 'localhost',
    'db_name' => 'blf_system',
    'db_user' => 'user',
    'db_pass' => 'password'
];
```

3. Create an empty database in MySQL/MariaDB: **blf_system**

Import the database structure:

```
mysql -u root -p blf_system < blf_structure.sql
```

*Note: The blf_structure.sql file contains only the table structure.*

4. Open **setup_admin.php** and change the default admin password (default is 1234).
(You can skip this step since you'll be able to change it after first login to the admin panel)

Run:
```
php setup_admin.php
```

*Note: The admin user is created only once. If you run this file again, it won't change the password because the user already exists, but it will show instructions for next steps. The admin user can only be deleted directly from the database.*

(I decided to implement it this way without a separate registration page - this is my preferred approach)

Set correct file permissions:

```
chown -R asterisk:asterisk /var/www/html/digium_phones
chmod -R 755 /var/www/html/digium_phones
```

üîÑ How It Works
User logs in with extension and password.

***editor.php*** interface allows editing up to 105 BLF contacts.

Saving the form generates an XML file: <ext>.xml.

Asterisk triggers phones to reload the updated configuration.

## üîê Security
Passwords are hashed with bcrypt

Input validation and access protection

**admin** user cannot be deleted

Supports session logout via **index.php?logout**

## üìå Requirements
**PHP 5.6+**

**MariaDB / MySQL**

Asterisk with Digium phones (XML BLF support)

Apache or Nginx with access to /var/www/html/digium_phones/


## üìÉ License
License: [GNU GPL v3](LICENSE)

## Photo

<img src="https://github.com/user-attachments/assets/966772b1-ce39-4580-9a66-5cea8f65ec41" width="25%">
<img src="https://github.com/user-attachments/assets/dad2fa73-19d9-4e63-b11a-7f0551cace4c" width="25%">
